<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEFL ITP Structure: Set 10 (Level 3)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;600&family=Sarabun:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Sarabun', 'Noto Sans Thai', sans-serif; }
        .option-btn { transition: all 0.2s; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .rationale-scroll::-webkit-scrollbar { width: 6px; }
        .rationale-scroll::-webkit-scrollbar-track { background: #f1f1f1; }
        .rationale-scroll::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex items-center justify-center p-4">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl overflow-hidden border border-slate-200 flex flex-col max-h-[95vh]" id="app-container">
        
        <!-- Header: Red Theme for Level 3 -->
        <div class="bg-red-700 p-6 text-white flex-none relative overflow-hidden">
            <div class="relative z-10">
                <a href="https://pls-c.github.io/English-Quiz/TOEFL_ITP_Section2-Structure/index.html" 
                   class="inline-flex items-center text-red-100 hover:text-white mb-4 text-sm font-medium transition-colors hover:bg-red-600/50 px-3 py-1.5 rounded-lg -ml-3">
                    <i class="fas fa-arrow-left mr-2"></i> กลับหน้าหลัก
                </a>
                
                <div class="flex justify-between items-end">
                    <div>
                        <h1 class="text-xl font-bold flex items-center gap-2">
                            <i class="fas fa-fire text-2xl"></i> TOEFL Structure (Advanced)
                        </h1>
                        <p class="text-red-200 text-xs mt-1">Set 10: Inversion, Subjunctive, Advanced S-V (Level 3)</p>
                    </div>
                    <div class="text-right">
                        <div class="text-xs text-red-200 uppercase tracking-wide font-semibold">Score</div>
                        <div class="text-3xl font-bold" id="score-display">0</div>
                    </div>
                </div>
            </div>
            <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-red-500 rounded-full opacity-30 blur-xl"></div>
        </div>

        <!-- Progress Bar -->
        <div class="w-full bg-gray-100 h-1.5 flex-none">
            <div class="bg-red-500 h-1.5 transition-all duration-300 ease-out" style="width: 0%" id="progress-bar"></div>
        </div>

        <!-- Content Area -->
        <div class="p-6 overflow-y-auto flex-grow rationale-scroll" id="content-area">
            <div id="question-view" class="fade-in">
                <div class="flex justify-between items-center mb-4">
                    <span class="px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold tracking-wide border border-gray-200" id="question-count">QUESTION 1/10</span>
                </div>
                <div class="mb-6">
                    <h2 class="text-xl text-gray-900 font-semibold leading-relaxed mb-2" id="question-text">Loading...</h2>
                    <p class="hidden text-red-700 text-sm italic font-medium bg-red-50 inline-block px-3 py-2 rounded-lg border border-red-100 fade-in" id="question-translation">Loading...</p>
                </div>
                <div class="space-y-3" id="options-container"></div>
                
                <!-- Feedback Area -->
                <div id="feedback-area" class="hidden mt-6 rounded-xl border overflow-hidden fade-in shadow-sm bg-white">
                    <div class="p-4" id="feedback-header">
                        <div class="flex items-center gap-2 font-bold text-lg" id="feedback-title"></div>
                    </div>
                    <div class="p-5 bg-gray-50 border-t border-gray-100 text-gray-700 text-sm leading-relaxed space-y-4" id="feedback-content"></div>
                    <!-- Vocab Section -->
                    <div class="bg-yellow-50 p-4 border-t border-yellow-100 text-sm text-gray-800">
                        <div class="font-bold text-yellow-800 flex items-center gap-2 mb-2">
                            <i class="fas fa-lightbulb text-yellow-500"></i> คำศัพท์น่ารู้ (Vocabulary Boost)
                        </div>
                        <div id="vocab-content" class="space-y-2 pl-6"></div>
                    </div>
                </div>
            </div>

            <!-- Result View -->
            <div id="result-view" class="hidden text-center py-8 fade-in h-full flex flex-col justify-center">
                <div class="mb-6 inline-block p-5 rounded-full bg-red-50 text-red-600">
                    <i class="fas fa-trophy text-6xl"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Quiz Completed!</h2>
                <p class="text-gray-500 mb-8">คะแนนรวมของคุณ</p>
                <div class="flex justify-center items-center mb-8">
                    <div class="bg-white px-10 py-6 rounded-2xl border border-gray-200 shadow-sm">
                        <span class="block text-gray-400 text-xs uppercase tracking-wider font-bold mb-1">Total Score</span>
                        <div class="flex items-baseline gap-1">
                            <span id="final-score" class="text-5xl font-bold text-red-600"></span>
                            <span class="text-gray-400 text-2xl font-medium">/ 10</span>
                        </div>
                    </div>
                </div>
                <div class="flex flex-col gap-3 justify-center items-center w-full">
                    <div class="flex gap-3 w-full justify-center">
                        <button onclick="reviewAnswers()" class="px-6 py-2.5 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium transition flex items-center gap-2">
                            <i class="fas fa-eye"></i> Review Answers
                        </button>
                        <button onclick="restartQuiz()" class="px-6 py-2.5 rounded-lg bg-red-600 text-white hover:bg-red-700 font-medium transition shadow-md hover:shadow-lg flex items-center gap-2">
                            <i class="fas fa-redo"></i> Try Again
                        </button>
                    </div>
                    <a href="https://pls-c.github.io/English-Quiz/TOEFL_ITP_Section2-Structure/index.html" class="text-red-500 hover:text-red-700 text-sm font-medium mt-4 flex items-center gap-1 transition-colors">
                        <i class="fas fa-home"></i> กลับหน้าหลัก
                    </a>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="bg-gray-50 p-4 border-t border-gray-200 flex justify-between items-center flex-none" id="footer-controls">
            <button id="prev-btn" onclick="prevQuestion()" class="hidden px-4 py-2 rounded-lg text-gray-500 hover:bg-gray-200 hover:text-gray-800 transition font-medium text-sm flex items-center gap-2 disabled:opacity-50"><i class="fas fa-arrow-left"></i> Back</button>
            <div id="spacer" class="hidden"></div>
            <button id="next-btn" onclick="nextQuestion()" class="hidden bg-gray-800 text-white px-6 py-2.5 rounded-lg hover:bg-gray-900 transition font-medium text-sm flex items-center gap-2 shadow-sm">Next <i class="fas fa-arrow-right"></i></button>
        </div>
    </div>

    <script>
        // Data Set: Set 10 (Level 3) - Advanced Structure
        const quizData = [
            {
                question: "Rarely __________ such a profound impact on society.",
                translation: "น้อยครั้งนักที่เหตุการณ์หนึ่งจะมีผลกระทบอย่างลึกซึ้งต่อสังคมเช่นนี้",
                vocab: ["Profound (Adj): ลึกซึ้ง", "Impact (N): ผลกระทบ"],
                options: [
                    { text: "does an event have", correct: true, rationale: "<b>Inversion:</b> ขึ้นต้นด้วย Negative Adverb (Rarely) ต้องกลับประโยคเอา V.ช่วย (does) มาหน้าประธาน" },
                    { text: "an event has", correct: false, rationale: "<b>ผิดกฎ Inversion:</b> เรียงแบบบอกเล่าไม่ได้" },
                    { text: "has an event", correct: false, rationale: "<b>ผิดโครงสร้าง:</b> ต้องใช้ V.ช่วย do/does ใน Present Simple" },
                    { text: "an event having", correct: false, rationale: "<b>ไม่มีกริยาแท้:</b> having เป็น Participle" }
                ]
            },
            {
                question: "It is essential that the CEO __________ the meeting in person.",
                translation: "จำเป็นอย่างยิ่งที่ CEO ต้องเข้าร่วมการประชุมด้วยตนเอง",
                vocab: ["Essential (Adj): จำเป็น", "Attend (V): เข้าร่วม"],
                options: [
                    { text: "attend", correct: true, rationale: "<b>Subjunctive Mood:</b> หลัง essential that... กริยาต้องเป็น Base form (ไม่เติม s)" },
                    { text: "attends", correct: false, rationale: "<b>ผิดกฎ Subjunctive:</b> ห้ามเติม s แม้ประธานเอกพจน์" },
                    { text: "attending", correct: false, rationale: "<b>กริยาไม่แท้:</b> ใช้ไม่ได้ใน Subjunctive clause" },
                    { text: "to attend", correct: false, rationale: "<b>ผิดรูปแบบ:</b> ใน that clause ต้องเป็น Subject + Verb" }
                ]
            },
            {
                question: "Not only __________ the deadline, but they also exceeded expectations.",
                translation: "ไม่เพียงแต่พวกเขาจะทันกำหนดเวลาเท่านั้น แต่ยังทำได้เกินความคาดหมายอีกด้วย",
                vocab: ["Exceed (V): เกินกว่า", "Deadline (N): กำหนดเวลา"],
                options: [
                    { text: "did they meet", correct: true, rationale: "<b>Inversion (Not only):</b> ต้องกลับประโยคโดยใช้ V.ช่วย (did) นำหน้าประธาน" },
                    { text: "they met", correct: false, rationale: "<b>ผิดกฎ Inversion:</b> เรียงแบบปกติไม่ได้" },
                    { text: "they did meet", correct: false, rationale: "<b>ผิดลำดับ:</b> did ต้องอยู่หน้า they" },
                    { text: "met they", correct: false, rationale: "<b>ผิดโครงสร้าง:</b> ย้ายกริยาแท้มาข้างหน้าไม่ได้" }
                ]
            },
            {
                question: "The number of students enrolled in the course __________ steadily.",
                translation: "จำนวนนักเรียนที่ลงทะเบียนในรายวิชานี้เพิ่มขึ้นอย่างต่อเนื่อง",
                vocab: ["Enroll (V): ลงทะเบียน", "Steadily (Adv): อย่างต่อเนื่อง"],
                options: [
                    { text: "has increased", correct: true, rationale: "<b>S-V Agreement:</b> 'The number of' (จำนวนของ) ถือเป็นเอกพจน์เสมอ จึงใช้ has" },
                    { text: "have increased", correct: false, rationale: "<b>ผิดพจน์:</b> 'A number of' ถึงจะเป็นพหูพจน์" },
                    { text: "increasing", correct: false, rationale: "<b>กริยาไม่แท้:</b> ขาด V.to be" },
                    { text: "increase", correct: false, rationale: "<b>ผิดพจน์:</b> ถ้าเป็น Present ต้องเติม s (increases)" }
                ]
            },
            {
                question: "Had the team been better prepared, they __________ the championship.",
                translation: "หากทีมเตรียมตัวมาดีกว่านี้ พวกเขาคงจะชนะการแข่งขันไปแล้ว",
                vocab: [
                    "<b>Prepare</b> (V): เตรียมตัว",
                    "<b>Championship</b> (N): การแข่งขันชิงแชมป์"
                ],
                options: [
                    { text: "would have won", correct: true, rationale: "<b>Inverted Conditional (Type 3):</b> Had... (If...had...) คู่กับ would have + V3" },
                    { text: "will win", correct: false, rationale: "<b>ผิด Tense:</b> Type 3 เป็นอดีตสมมติ" },
                    { text: "would win", correct: false, rationale: "<b>ผิด Tense:</b> นี่เป็น Type 2 (ปัจจุบันสมมติ)" },
                    { text: "won", correct: false, rationale: "<b>ผิดโครงสร้าง:</b> ขาด Modal verb" }
                ]
            },
            {
                question: "__________ that the problem was solved, he went home.",
                translation: "เมื่อมั่นใจว่าปัญหาได้รับการแก้ไขแล้ว เขาจึงกลับบ้าน",
                vocab: [
                    "<b>Satisfied</b> (Adj/Participle): พอใจ, มั่นใจ",
                    "<b>Solve</b> (V): แก้ปัญหา"
                ],
                options: [
                    { text: "Satisfied", correct: true, rationale: "<b>Past Participle Phrase:</b> ลดรูปจาก 'Because he was satisfied...' (ประธานรู้สึกพอใจเอง)" },
                    { text: "Satisfying", correct: false, rationale: "<b>ความหมายผิด:</b> แปลว่า 'น่าพอใจ' (เขาเป็นคนน่าพอใจ? ไม่ใช่)" },
                    { text: "To satisfy", correct: false, rationale: "<b>ผิดความหมาย:</b> เพื่อที่จะทำให้พอใจ (บอกวัตถุประสงค์) ไม่เข้ากับบริบท" },
                    { text: "Satisfaction", correct: false, rationale: "<b>ผิดหน้าที่คำ:</b> Noun phrase ลอยๆ ไม่สื่อความหมายการกระทำ" }
                ]
            },
            {
                question: "Physics __________ a difficult subject for many students.",
                translation: "ฟิสิกส์เป็นวิชาที่ยากสำหรับนักเรียนหลายคน",
                vocab: ["Physics (N): วิชาฟิสิกส์", "Subject (N): วิชา"],
                options: [
                    { text: "is", correct: true, rationale: "<b>S-V Agreement:</b> ชื่อวิชาที่ลงท้ายด้วย s (Physics, Mathematics) ถือเป็นเอกพจน์" },
                    { text: "are", correct: false, rationale: "<b>ผิดพจน์:</b> ชื่อวิชาเป็นเอกพจน์เสมอ" },
                    { text: "being", correct: false, rationale: "<b>กริยาไม่แท้:</b> เป็นกริยาหลักไม่ได้" },
                    { text: "to be", correct: false, rationale: "<b>กริยาไม่แท้:</b> เป็นกริยาหลักไม่ได้" }
                ]
            },
            {
                question: "The jury __________ reached a verdict.",
                translation: "คณะลูกขุนได้ข้อสรุปคำตัดสินแล้ว",
                vocab: ["Jury (N): คณะลูกขุน", "Verdict (N): คำตัดสิน"],
                options: [
                    { text: "has", correct: true, rationale: "<b>Collective Noun:</b> Jury ในที่นี้มองเป็นกลุ่มก้อนเดียว (เอกพจน์) ที่เห็นพ้องต้องกัน" },
                    { text: "have", correct: false, rationale: "<b>บริบท:</b> จะใช้ have ถ้าสมาชิกในกลุ่มมีความเห็นขัดแย้งกัน" },
                    { text: "having", correct: false, rationale: "<b>กริยาไม่แท้:</b> ขาด V.to be" },
                    { text: "to have", correct: false, rationale: "<b>กริยาไม่แท้:</b> เป็นกริยาหลักไม่ได้" }
                ]
            },
            {
                question: "Mr. Smith, along with his two sons, __________ arriving tonight.",
                translation: "คุณสมิธ พร้อมด้วยลูกชายสองคน กำลังจะมาถึงคืนนี้",
                vocab: ["Arrive (V): มาถึง", "Tonight (Adv): คืนนี้"],
                options: [
                    { text: "is", correct: true, rationale: "<b>S-V Agreement:</b> ประธานหลักคือ Mr. Smith (เอกพจน์) วลี 'along with...' ไม่เปลี่ยนพจน์ประธาน" },
                    { text: "are", correct: false, rationale: "<b>ผิดพจน์:</b> หลงกล sons ในส่วนขยาย" },
                    { text: "were", correct: false, rationale: "<b>ผิด Tense:</b> tonight เป็นอนาคตใกล้ๆ ใช้ Present Continuous ได้ แต่ were เป็นอดีต" },
                    { text: "be", correct: false, rationale: "<b>กริยาไม่ผัน:</b> ใช้เป็นกริยาหลักไม่ได้" }
                ]
            },
            {
                question: "__________ by the noise, she closed the window.",
                translation: "เพราะถูกรบกวนด้วยเสียงดัง เธอจึงปิดหน้าต่าง",
                vocab: ["Disturb (V): รบกวน", "Noise (N): เสียงดัง"],
                options: [
                    { text: "Disturbed", correct: true, rationale: "<b>Passive Participle:</b> ลดรูปจาก 'Because she was disturbed...' (ประธานถูกกระทำ)" },
                    { text: "Disturbing", correct: false, rationale: "<b>Active Participle:</b> แปลว่า 'เธอกำลังรบกวนคนอื่น' ซึ่งผิดบริบท" },
                    { text: "Disturb", correct: false, rationale: "<b>ผิดหน้าที่คำ:</b> V.1 ขึ้นต้นประโยคไม่ได้ (ยกเว้นคำสั่ง)" },
                    { text: "To disturb", correct: false, rationale: "<b>ผิดความหมาย:</b> เพื่อที่จะรบกวน (บอกวัตถุประสงค์)" }
                ]
            }
        ];

        // --- Standard Logic ---
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        quizData.forEach(q => shuffleArray(q.options));

        let currentQuestion = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let isAnswered = new Array(quizData.length).fill(false);

        function initQuiz() {
            currentQuestion = 0;
            userAnswers.fill(null);
            isAnswered.fill(false);
            document.getElementById('result-view').classList.add('hidden');
            document.getElementById('question-view').classList.remove('hidden');
            document.getElementById('footer-controls').classList.remove('hidden');
            document.getElementById('question-view').classList.add('fade-in');
            loadQuestion(0);
        }

        function loadQuestion(index) {
            currentQuestion = index;
            const data = quizData[currentQuestion];
            const answered = isAnswered[currentQuestion];
            const userChoice = userAnswers[currentQuestion];

            document.getElementById('question-count').innerText = `QUESTION ${currentQuestion + 1}/${quizData.length}`;
            
            const currentScore = userAnswers.reduce((acc, ans, idx) => {
                if (ans !== null && quizData[idx].options[ans].correct) return acc + 1;
                return acc;
            }, 0);
            document.getElementById('score-display').innerText = currentScore;

            document.getElementById('question-text').innerHTML = data.question;
            const translationEl = document.getElementById('question-translation');
            translationEl.innerHTML = `<i class="fas fa-language mr-1"></i> ${data.translation}`;
            
            if (answered) translationEl.classList.remove('hidden');
            else translationEl.classList.add('hidden');
            
            const progress = ((currentQuestion) / quizData.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            data.options.forEach((option, idx) => {
                const btn = document.createElement('button');
                // Red theme for Level 3
                const hoverClass = 'hover:bg-red-50 hover:border-red-300'; 
                btn.className = `option-btn w-full text-left p-4 rounded-xl border border-gray-200 focus:outline-none mb-1 bg-white text-gray-700 font-medium flex items-start gap-3 ${hoverClass}`;
                
                const marker = `<span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-red-50 text-red-600 text-xs font-bold flex-shrink-0 mt-0.5">${String.fromCharCode(65 + idx)}</span>`;
                btn.innerHTML = `${marker} <span class="leading-relaxed">${option.text}</span>`;
                btn.onclick = () => handleAnswer(idx);

                if (answered) {
                    btn.disabled = true;
                    btn.classList.remove('hover:bg-red-50', 'hover:border-red-300');
                    if (option.correct) {
                        btn.className = `w-full text-left p-4 rounded-xl border-2 border-green-500 bg-green-50 text-green-800 font-medium flex items-start gap-3 shadow-sm`;
                        btn.innerHTML = `<i class="fas fa-check-circle text-2xl text-green-500 flex-shrink-0"></i> <span class="leading-relaxed">${option.text}</span>`;
                    } else if (idx === userChoice && !option.correct) {
                        btn.className = `w-full text-left p-4 rounded-xl border-2 border-red-400 bg-red-50 text-red-800 font-medium flex items-start gap-3 opacity-90`;
                        btn.innerHTML = `<i class="fas fa-times-circle text-2xl text-red-500 flex-shrink-0"></i> <span class="leading-relaxed">${option.text}</span>`;
                    } else {
                        btn.className += ' opacity-50 grayscale';
                    }
                }
                optionsContainer.appendChild(btn);
            });

            const feedbackArea = document.getElementById('feedback-area');
            const feedbackTitle = document.getElementById('feedback-title');
            const feedbackContent = document.getElementById('feedback-content');
            const feedbackHeader = document.getElementById('feedback-header');
            const vocabContent = document.getElementById('vocab-content');

            if (answered) {
                feedbackArea.classList.remove('hidden');
                feedbackArea.classList.add('fade-in');
                const isCorrect = quizData[currentQuestion].options[userChoice].correct;
                vocabContent.innerHTML = data.vocab.map(v => `<div class="flex items-start gap-2"><i class="fas fa-circle text-yellow-500 text-xs mt-1.5"></i><span>${v}</span></div>`).join('');

                if (isCorrect) {
                    feedbackHeader.className = "p-4 bg-green-100 text-green-800 border-b border-green-200";
                    feedbackTitle.innerHTML = '<i class="fas fa-check-circle"></i> ถูกต้อง! (Correct)';
                    feedbackContent.innerHTML = quizData[currentQuestion].options[userChoice].rationale;
                } else {
                    feedbackHeader.className = "p-4 bg-red-100 text-red-800 border-b border-red-200";
                    feedbackTitle.innerHTML = '<i class="fas fa-exclamation-circle"></i> ไม่ถูกต้อง (Incorrect)';
                    const correctOptionIndex = quizData[currentQuestion].options.findIndex(o => o.correct);
                    const correctRationale = quizData[currentQuestion].options[correctOptionIndex].rationale;
                    const wrongRationale = quizData[currentQuestion].options[userChoice].rationale;
                    feedbackContent.innerHTML = `
                        <div class="mb-3 pb-3 border-b border-gray-200">
                             <div class="text-red-700 font-semibold mb-1">สิ่งที่คุณเลือกผิดเพราะ:</div>
                             <div class="text-gray-600">${wrongRationale.replace(/<b>.*?<\/b>/, '')}</div>
                        </div>
                        <div>
                            <span class="font-bold text-green-700">คำตอบที่ถูกคือข้อ ${String.fromCharCode(65+correctOptionIndex)}</span> เพราะ ${correctRationale}
                        </div>
                    `;
                }
            } else {
                feedbackArea.classList.add('hidden');
            }

            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            if (currentQuestion > 0) { prevBtn.classList.remove('hidden'); prevBtn.disabled = false; } else { prevBtn.classList.add('hidden'); }
            if (answered) { nextBtn.classList.remove('hidden'); nextBtn.innerHTML = currentQuestion === quizData.length - 1 ? 'See Results <i class="fas fa-chart-bar"></i>' : 'Next <i class="fas fa-arrow-right"></i>'; } else { nextBtn.classList.add('hidden'); }
            document.getElementById('content-area').scrollTop = 0;
        }

        function handleAnswer(selectedIndex) {
            userAnswers[currentQuestion] = selectedIndex;
            isAnswered[currentQuestion] = true;
            loadQuestion(currentQuestion);
            setTimeout(() => { document.getElementById('content-area').scrollTo({ top: document.getElementById('content-area').scrollHeight, behavior: 'smooth' }); }, 100);
        }

        function prevQuestion() { if (currentQuestion > 0) { currentQuestion--; loadQuestion(currentQuestion); } }
        function nextQuestion() { if (currentQuestion < quizData.length - 1) { currentQuestion++; loadQuestion(currentQuestion); } else { showResult(); } }

        function showResult() {
            document.getElementById('question-view').classList.add('hidden');
            document.getElementById('footer-controls').classList.add('hidden');
            document.getElementById('result-view').classList.remove('hidden');
            const finalScore = userAnswers.reduce((acc, ans, idx) => { if (ans !== null && quizData[idx].options[ans].correct) return acc + 1; return acc; }, 0);
            document.getElementById('final-score').innerText = finalScore;
            document.getElementById('progress-bar').style.width = `100%`;
        }

        function reviewAnswers() {
            document.getElementById('result-view').classList.add('hidden');
            document.getElementById('question-view').classList.remove('hidden');
            document.getElementById('footer-controls').classList.remove('hidden');
            loadQuestion(0);
        }

        function restartQuiz() { initQuiz(); }
        initQuiz();
    </script>
</body>
</html>